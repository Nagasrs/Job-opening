# RAW DATA
Select * FROM Jobs_posting
LIMIT 20;
SELECT 
Job_id,
Job_Title,
Job_Location,
Job_Type,
Salary_year_avg
Job_Posted_Date
FROM Jobs_posting
WHERE Salary_year_avg is NOT NULL;
# Filter to relevant roles
SELECT 
Job_id, 
Job_Title, 
Job_location, 
Job_Type, 
Job_Posted_Date
salary_year_avg 
FROM job_postings
WHERE salary_year_avg IS NOT NULL AND job_title_short = 'Data Analyst' AND Job_Posted_Date> Current_Date;
ORDER BY
Salary_Year_avg DESC;
# Top Paying Analyst Jobs
SELECT
Job_id,
Job_Title,
Job_location,
Job_Type,
Salary_Year_avg
FROM job_Postings
WHERE slary_year_avg IS NOT NULL
AND job_title_short = 'Data Analyst'
ORDER BY Salary_Year_avg DESC
LIMIT 20;
# Most Demand Skills
SELECT s.Skills,
COUNT(sj.Job_id) AS Demand_Count
FROM Job_Postings
INNER JOIN skills_dim sj
ON j.job_id = sj.job_id
INNER JOIN skills_dim s
ON sj.skill_id = s.skill_id
WHERE
j.Job_Title_short = 'DATA ANALYST'
GROUP BY
s.skills
ORDER BY
demand_Count DESC
LIMIT 20;
SELECT s.skills, 
ROUND(AVG(j.salary_year_avg), 0) AS avg_salary, 
COUNT(sj.job_id) AS job_count 
FROM job_postings j
INNER JOIN skills_job_dim sj 
ON j.job_id = sj.job_id
INNER JOIN skills_dim s 
ON sj.skill_id = s.skill_id
WHERE j.job_title_short = 'Data Analyst'
AND j.salary_year_avg IS NOT NULL
GROUP BY s.skills
ORDER BY avg_salary DESC
LIMIT 25;
